{% extends "AdminSide/base.html" %}

{% block title %}Edit Product{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Edit Product: {{ product.product_name }}</h2>
    
    <form method="post">
        {% csrf_token %}
        <div class="form-group">
            <label for="product_name">Product Name</label>
            <input type="text" name="product_name" id="product_name" value="{{ product.product_name }}" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="product_description">Product Description</label>
            <textarea name="product_description" id="product_description" class="form-control" required>{{ product.product_description }}</textarea>
        </div>
        <div class="form-group">
            <label for="product_category">Product Category</label>
            <select name="product_category" id="product_category" class="form-control" required>
                {% for category in categories %}
                    <option value="{{ category.id }}" {% if product.product_category and product.product_category.id == category.id %}selected{% endif %}>
                        {{ category.category_name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="product_brand">Product Brand</label>
            <select name="product_brand" id="product_brand" class="form-control" required>
                {% for brand in brands %}
                    <option value="{{ brand.id }}" {% if product.product_brand and product.product_brand.id == brand.id %}selected{% endif %}>
                        {{ brand.brand_name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="price" class="form-label">New Price</label>
            <input 
                type="number" 
                name="price" 
                id="price" 
                value="{{ product.price }}" 
                class="form-control" 
                min="0" <!-- Sets the minimum value to 0 -->
                placeholder="Enter the new price" 
                required 
            >
        </div>
        
        </div>
        <div class="form-group">
            <label for="offer_price">Offer Price</label>
            <input type="number" name="offer_price" id="offer_price" value="{{ product.offer_price }}"  class="form-control">
        </div>
        <div class="form-group form-check">
            <input type="checkbox" name="is_active" id="is_active" class="form-check-input" {% if product.is_active %}checked{% endif %}>
            <label class="form-check-label" for="is_active">Active</label>
        </div>
        <button type="submit" class="btn btn-primary">Save Changes</button>
        <a href="{% url 'products:products_list' %}" class="btn btn-secondary">Cancel</a>
    </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        {% if messages %}
            const messages = [
                {% for message in messages %}
                    {
                        level: "{{ message.tags }}",
                        text: "{{ message }}"
                    },
                {% endfor %}
            ];
            messages.forEach(message => {
                Swal.fire({
                    toast: true,
                    position: 'top-right',
                    icon: message.level === 'success' ? 'success' : 'error',
                    title: message.text,
                    showConfirmButton: false,
                    timer: 3000
                });
            });
        {% endif %}
    });
</script>
{% endblock %}
