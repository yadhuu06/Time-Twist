{% extends "UserSide/base.html" %}
{% load static %}

{% block content %}
<!-- Start Banner Area -->
<section class="banner-area organic-breadcrumb">
    <div class="container">
        <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
            <div class="col-first">
                <h1>Product Details</h1>
                <nav class="d-flex align-items-center">
                    <a href="">Home<span class="lnr lnr-arrow-right"></span></a>
                    <a href="#">Shop<span class="lnr lnr-arrow-right"></span></a>
                    <a href="#">Product Details</a>
                </nav>
            </div>
        </div>
    </div>
</section>
<!-- End Banner Area -->

<!--================Single Product Area =================-->
<div class="container mt-5">
    <div class="row">
        <!-- Product Images -->
        <div class="col-lg-6 mb-4">
            <div id="productImagesCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    {% for variant in product.variants.all %}
                        {% for image in variant.images.all %}
                            <div class="carousel-item {% if forloop.first and forloop.parentloop.first %}active{% endif %}" data-variant="{{ variant.id }}">
                                <img src="{{ image.image.url }}" class="d-block w-100 product-image img-fluid" alt="{{ product.product_name }}">
                            </div>
                        {% endfor %}
                    {% endfor %}
                </div>
                <a class="carousel-control-prev" href="#productImagesCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true" style="background-color: black;"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#productImagesCarousel" role="button" data-slide="next">
					<span class="carousel-control-next-icon" aria-hidden="true" style="background-color: black;"></span>
					<span class="sr-only">Next</span>
				</a>
            </div>
        </div>

        <!-- Product Details -->
        <div class="col-lg-6">
            <h2 class="mb-3">{{ product.product_name }}</h2>
            <h4 class="text-success mb-3">${{ product.offer_price }}</h4>
            
            <p class="mb-4">{{ product.product_description }}</p>
            
            <div class="mb-4">
                <h5>Select Color:</h5>
                <div class="btn-group-toggle" data-toggle="buttons">
					{% for variant in product.variants.all %}
						<label class="btn btn-outline-secondary mr-2 mb-2" style="background-color: {{ variant.colour_code }};">
							<input type="radio" name="color" value="{{ variant.id }}"> 
							<span style="color: #fff; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);">
				
							</span>
						</label>
					{% endfor %}
				</div>
            </div>
            
            <div class="mb-4">
                <h5>Quantity:</h5>
                <div class="input-group" style="max-width: 200px;">
                    <div class="input-group-prepend">
                        <button class="btn btn-outline-secondary" type="button" id="quantity-minus">-</button>
                    </div>
                    <input type="text" class="form-control text-center" value="1" id="quantity">
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary" type="button" id="quantity-plus">+</button>
                    </div>
                </div>
            </div>
            
            <button class="btn btn-primary btn-lg mb-4" id="addToCartBtn">Add to Cart</button>
            
            <div>
                <h5>Product Details:</h5>
                <ul class="list-unstyled">
                    <li><strong>Brand:</strong> {{ product.product_brand.brand_name }}</li>
                    <li><strong>Category:</strong> {{ product.product_category.category_name }}</li>
                    {% if product.offer_price %}
                        <li><strong>Discount:</strong> {{ product.offer_price_percentage|floatformat:2 }}% OFF</li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
</div>
<!--================End Single Product Area =================-->

<!--================Product Description Area =================-->
<section class="product_description_area">
    <div class="container">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Description</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Specification</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false">Comments</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="review-tab" data-toggle="tab" href="#review" role="tab" aria-controls="review" aria-selected="false">Reviews</a>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                <p>{{ product.product_description }}</p>
            </div>
            <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                <!-- Add product specifications here -->
            </div>
            <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                <!-- Add comments section here -->
            </div>
            <div class="tab-pane fade" id="review" role="tabpanel" aria-labelledby="review-tab">
                <!-- Add reviews section here -->
            </div>
        </div>
    </div>
</section>
<!--================End Product Description Area =================-->

<script>
document.addEventListener('DOMContentLoaded', function() {
    const colorButtons = document.querySelectorAll('input[name="color"]');
    const carousel = document.querySelector('#productImagesCarousel');
    const quantityInput = document.querySelector('#quantity');
    const minusBtn = document.querySelector('#quantity-minus');
    const plusBtn = document.querySelector('#quantity-plus');

    colorButtons.forEach(button => {
        button.addEventListener('change', function() {
            const variantId = this.value;
            const targetSlide = carousel.querySelector(`.carousel-item[data-variant="${variantId}"]`);
            if (targetSlide) {
                $(carousel).carousel($(targetSlide).index());
            }
        });
    });

    minusBtn.addEventListener('click', function() {
        let value = parseInt(quantityInput.value);
        if (value > 1) quantityInput.value = value - 1;
    });

    plusBtn.addEventListener('click', function() {
        let value = parseInt(quantityInput.value);
        quantityInput.value = value + 1;
    });
});
</script>

{% endblock %}